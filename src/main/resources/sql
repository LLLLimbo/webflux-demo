CREATE TABLE `empty_situation_schema_dim` (
                                              `pid` bigint(20) NOT NULL AUTO_INCREMENT,
                                              `house_space_id` varchar(32) DEFAULT NULL,
                                              `house_space_manager_id` varchar(32) DEFAULT NULL,
                                              `block_id` varchar(32) DEFAULT NULL,
                                              `unit_id` varchar(32) DEFAULT NULL,
                                              `company_id` varchar(32) DEFAULT NULL,
                                              `block_name` varchar(32) DEFAULT NULL,
                                              `cur_status` varchar(32) DEFAULT NULL,
                                              `company_name` varchar(32) DEFAULT NULL,
                                              `unit_name` varchar(32) DEFAULT NULL,
                                              `house_create_time` datetime DEFAULT NULL,
                                              PRIMARY KEY (`pid`)
) ENGINE=InnoDB AUTO_INCREMENT=16384 DEFAULT CHARSET=utf8mb4


CREATE TABLE `empty_situation_schema_fact` (
                                               `pid` bigint(20) NOT NULL AUTO_INCREMENT,
                                               `logged_year` int(11) DEFAULT NULL,
                                               `bitset` varchar(128) DEFAULT NULL,
                                               `dim_id` bigint(20) DEFAULT NULL,
                                               PRIMARY KEY (`pid`),
                                               KEY `empty_situation_schema_fact_dim_id_index` (`dim_id`)
) ENGINE=InnoDB AUTO_INCREMENT=1785 DEFAULT CHARSET=latin1



insert into empty_situation_schema_dim(pid, house_space_id, house_space_manager_id, block_id, unit_id, company_id,
                                       block_name, unit_name, company_name, cur_status,house_create_time)
select null,
       hs.id,
       hsm.id,
       hsm.block_id,
       hsm.zone_id,
       hsm.company_id,
       hsm.block_name,
       hsm.zone,
       company.company_name,
       hs.house_space_status,
       hs.create_time
from house_space hs
         left join house_space_manager hsm on hs.house_space_manager_id = hsm.id
         left join house.company on hsm.company_id = company.id